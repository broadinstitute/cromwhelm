{{ include "terra-batch-libchart.wds-deploy" (list . "coa-helm.wds-deploy") }}
{{ define "coa-helm.wds-deploy" }}
{{ end }}

---

{{ include "terra-batch-libchart.wds-service" (list . "coa-helm.wds-service") }}
{{ define "coa-helm.wds-service" }}
{{ end }}

---

{{ include "terra-batch-libchart.wds-config" (list . "cromwell-helm.wds-config") }}
{{ define "cromwell-helm.wds-config" }}
data:
  {{ .Values.config.wds.conf_file }}: |-
    spring:
      datasource:
        url: jdbc:mysql://mysqldb:{{ .Values.db.port }}/{{ .Values.db.wds.dbname }}?useSSL=false&rewriteBatchedStatements=true&allowPublicKeyRetrieval=true
        username: {{ .Values.db.user }}
        password: {{ include "dbPassword" . | b64enc | quote }}
      liquibase:
        change-log: classpath:db/changelog.xml
        enabled: true
{{ end }}
